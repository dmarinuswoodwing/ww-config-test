{"version":3,"sources":["Components/App/App.js","Components/Gallery/Gallery.js","Components/ImageThumbnail/ImageThumbnail.js","Components/Panels/Panels.js","images/folder-open.png","images/folder.png","serviceWorker.js","index.js","helpers/elvis.js","helpers/delete_api.js"],"names":["Object","defineProperty","Array","prototype","value","howMany","idx","result","this","length","push","App","csv","deletedByField","window","elvisContext","plugin","configProperties","deleted_by_field","deletedOnField","deleted_on_field","trashPath","trash_folder","apiUrl","api","isAdmin","app","userProfile","text","messages","state","downloadCSV","selectedUserIndex","userList","dropdownList","user","expanded","checked","usersDeletes","totalAssets","selectedFolder","nodes","imageCollection","viewableImages","selectedAssets","isLoading","currentPage","restoreFolderDisabled","restoreAssetsDisabled","showConfirm","folderFileCount","modalAccentFunc","includeSubFolders","showProgress","jobProgress","jobProgressMax","showDownloadCSV","level","selectedUser","DeleteApi","init","then","setState","getUsers","getDeletes","username","secretKey","iv","crypto","randomBytes","cipher","createCipheriv","encrypted","Buffer","concat","update","final","toString","content","ElvisDriver","res","users","facets","forEach","o","index","Item","onSelect","onDropdownSelect","bind","catch","err","console","log","isadmin","offSet","encode","JSON","stringify","count","key","payload","data","status","json","alert","arrayUniqueByKey","Map","hits","map","item","values","createTreeNodes","deletedOn","assetPath","path","arr","replace","split","f","folder","indexOf","sort","reduce","c","v","a","i","p","childrens","find","x","name","trim","type","label","Promise","resolve","pop","parent","join","obj","split2","parse","selected","ids","element","props","id","filtered","filter","del","startsWith","onRestoreFolder","modalAssetsOrFolder","processResponse","chunk","onRestoreAssets","e","response","reject","queue","restoreAsset","runQueue","error","items","func","shift","call","temp","assetSelection","restore","prevState","params","q","num","getUserDeletes","totalHits","metadata","list","total","hitCount","deletedon1","deletedon2","deletedon3","deletedon4","deletedon5","assetpath1","assetpath2","assetpath3","assetpath4","assetpath5","moment","format","getAllUsersInfo","event","newlist","dropdownValue","CustomToggle","React","forwardRef","ref","children","onClick","class","preventDefault","style","display","paddingLeft","CustomMenu","className","labeledBy","aria-labelledby","autoFocus","placeholder","onChange","target","Children","toArray","child","toLowerCase","nothingFoundMessage","height","borderRight","margin","drop","Toggle","as","variant","size","fontWeight","Menu","marginLeft","Check","custom","onSubFolderCheckboxChange","disabled","confirmFolderRestore","marginRight","confirmAssetRestore","orientation","minSize","flex","backgroundColor","selAssets","asset","cursor","overflow","onPageclick","onImageChange","onSelectAll","fullPage","loading","show","onHide","backdrop","Header","Title","fontSize","Body","Footer","padding","centered","now","max","Math","floor","filename","Component","Gallery","handlePageClick","newOffset","assetsPerPage","images","setItemOffset","itemOffset","order","b","hasOwnProperty","varA","toUpperCase","varB","comparison","compareValues","cf_deletedOn","assetId","W","imageSelect","slice","createStuff","hitsLength","totalLength","pageCount","width","breakLabel","nextLabel","onPageChange","pageRangeDisplayed","previousLabel","renderOnZeroPageCount","pluginSettings","require","ImageThumbnail","url","headerEncrypted","detailsEncrypted","algorithm","location","protocol","host","getThumbnail","imageStyle","popover","minWidth","Content","Moment","placement","overlay","popperConfig","modifiers","applyStyles","preventOverflow","boundariesElement","enabled","hide","delay","offsetTop","backgroundImage","StyledPanels","styled","div","StyledText","StyledIcon","img","isSelected","isCurrentPath","StyledFolder","FolderItem","isOpen","selectedPath","currentLevel","useState","setIsOpen","handleToggle","Popover","color","OverlayTrigger","alt","src","Panel","nameA","nameB","Panels","newPaths","paths","panels","panel","FolderPanels","setPaths","selectedPaths","setSelectedPaths","setCurrentLevel","FragWorkAround","elements","sizes","el","propagate","newSelected","g","Boolean","hostname","match","getElvisContext","process","navigator","serviceWorker","ready","registration","unregister","ReactDOM","render","document","getElementById","serverUrl","resolvedLogin","_getFolderPath","activeTab","folderSelection","_retrieveToken","fetch","credentials","csrfToken","loginParam","withCookie","folderPath","client","Elvis","createClient","login","waitForLogin","browse","options","includeAsset","search","query","_token","_apitoken","setToken","token","setApiToken","getToken","getApiToken","getHeadersWithDefaults","headers","server_url","password","newHeader","api_key","trashpath","Authorization","deleteApiURL","elvisDriver","sendDelete","request","Request","method","body","Headers"],"mappings":"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","file":"static/js/main.49e58410.chunk.js","sourcesContent":["import React, { PureComponent as Component } from 'react';\nimport { Modal, ButtonToolbar, ProgressBar, Dropdown, Form } from 'react-bootstrap'\nimport { ReflexContainer, ReflexSplitter, ReflexElement } from 'react-reflex'\nimport DeleteApi from '../../helpers/delete_api'\nimport crypto from 'crypto'\nimport Gallery from '../Gallery/Gallery'\nimport Panels from '../Panels/Panels'\nimport { Loader } from 'react-overlay-loader'\nimport { CSVLink, CSVDownload } from \"react-csv\";\nimport ElvisDriver from '../../helpers/elvis'\n\nimport './App.css'\nimport moment from 'moment';\n\n/*eslint no-extend-native:*/\nObject.defineProperty(Array.prototype, 'chunk', {\n  value: function (howMany) {\n    var idx = 0\n    let result = []\n\n    while (idx < this.length) {\n      if (idx % howMany === 0) result.push([])\n      result[result.length - 1].push(this[idx++])\n    }\n\n    return result\n  }\n})\n\nclass App extends Component {\n  constructor() {\n    super()\n\n    this.csv = []\n\n    this.deletedByField = window.elvisContext.plugin.configProperties.deleted_by_field.value\n    this.deletedOnField = window.elvisContext.plugin.configProperties.deleted_on_field.value\n    this.trashPath = window.elvisContext.plugin.configProperties.trash_folder.value\n    this.apiUrl = window.elvisContext.plugin.configProperties.api.value\n    this.isAdmin = window.elvisContext.app.userProfile.isAdmin\n    this.userProfile = window.elvisContext.app.userProfile\n\n    this.text = window.elvisContext.plugin.messages\n\n    this.state = {\n      csv: [],\n      downloadCSV: false,\n      selectedUserIndex: -1,\n      isAdmin: false,\n      userList: [],\n      dropdownList: [],\n      user: {},\n      expanded: [],\n      checked: [],\n      usersDeletes: [],\n      totalAssets: [],\n      selectedFolder: '',\n      nodes: [],\n      imageCollection: [],\n      viewableImages: [],\n      selectedAssets: [],\n      isLoading: true,\n      currentPage: 0,\n      restoreFolderDisabled: true,\n      restoreAssetsDisabled: true,\n      showConfirm: false,\n      folderFileCount: 0,\n      modalAccentFunc: null,\n      includeSubFolders: true,\n      showProgress: false,\n      jobProgress: 0,\n      jobProgressMax: 0,\n      showDownloadCSV: false,\n      level: 0,\n      selectedUser: null\n    }\n  }\n\n  componentDidMount() {\n    DeleteApi.init(this.apiUrl, this.trashPath, this.deletedByField)\n      .then(() => {\n        this.setState({ user: this.userProfile, isAdmin: this.isAdmin }, () => {\n          if (this.isAdmin) {\n            this.getUsers()\n          } else {\n            this.getDeletes(this.userProfile.username)\n          }\n        })\n      })\n  }\n\n  encode(text, secretKey) {\n    const iv = crypto.randomBytes(16)\n    const algorithm = 'aes-256-ctr'\n    const cipher = crypto.createCipheriv(algorithm, secretKey, iv)\n    const encrypted = Buffer.concat([cipher.update(text), cipher.final()])\n    return {\n      iv: iv.toString('hex'),\n      content: encrypted.toString('hex')\n    };\n  }\n\n  getUsers() {\n    ElvisDriver.init()\n      .then(() => {\n        DeleteApi.getUsers()\n          .then(res => {\n            let users = []\n            if (res.facets[this.deletedByField]) {\n              res.facets[this.deletedByField].forEach((o, index) => {\n                users.push(<Dropdown.Item onSelect={this.onDropdownSelect.bind(this, o, index)} value={o.value}>{o.value}</Dropdown.Item>)\n              })\n              this.setState({ dropdownList: users, userList: res.facets[this.deletedByField], isLoading: false })\n            }\n          })\n          .catch(err => {\n            console.log({ err })\n          })\n      })\n\n  }\n\n  getDeletes(username, isadmin, offSet = 0) {\n    let encrypted = this.encode(JSON.stringify({ user: username, count: offSet }), window.elvisContext.plugin.configProperties.key.value)\n    let payload = {\n      index: encrypted.iv,\n      data: encrypted.content\n    }\n    DeleteApi.getDeletes(payload)\n      .then(res => {\n\n        if (res.status == 200) {\n          return res.json()\n        } else {\n          alert(res.status)\n        }\n      })\n      .catch(err => {\n        console.log(err)\n      })\n      .then(json => {\n        // console.log({ json })\n\n        const arrayUniqueByKey = [...new Map(this.state.totalAssets.concat(json.hits).map(item =>\n          [item[\"id\"], item])).values()];\n\n        if (!isadmin) {\n          let userList = [{}]\n          userList[0].deletedOn = json.hits.map(o => { return { value: o[this.deletedOnField].value, assetPath: o.path } })\n\n          this.setState({ userList, usersDeletes: json, selectedUserIndex: 0, totalAssets: arrayUniqueByKey }, () => {\n            this.createTreeNodes(json.hits)\n          })\n        } else {\n          this.setState({ usersDeletes: json, totalAssets: arrayUniqueByKey, currentPage: 0 }, () => {\n            this.createTreeNodes(json.hits)\n          })\n        }\n      })\n  }\n\n  createTreeNodes2(data) {\n    let arr = []\n    data.forEach(item => {\n      let path = item.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '')\n      let split = path.split('/')\n      for (let f = split.length; f >= 1; f -= 1) {\n        let folder = split[f]\n        path = path.replace(`/${folder}`, '')\n        /*eslint no-unused-expressions:*/\n        arr.indexOf(path) === -1 ? arr.push(path) : null\n      }\n      /*eslint no-unused-expressions:*/\n      arr.indexOf(path) === -1 ? arr.push(path) : null\n    })\n\n    var result = arr.sort().reduce((c, v) => {\n      v.split('/').reduce((a, o, i) => {\n        if (i === 0) var p = a\n        else var p = a.childrens = a.childrens || []\n\n        var f = p.find(x => x.name === o.trim())\n\n        if (!f) {\n          f = { type: 'folder', path: v, name: o.trim(), label: o.trim() } //, icon: <img alt=\"folder\" src={folderIcon} /> \n          p.push(f)\n        }\n        return f\n      }, c)\n\n      return c\n    }, [])\n    this.setState({ nodes: result, expanded: arr, isLoading: false })\n    return Promise.resolve()\n  }\n\n\n  createTreeNodes(data) {\n\n    let arr = []\n    data.forEach(item => {\n      item.path = item.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '')\n      let split = item.path.split('/')\n      let name = split.pop()\n      let parent = split.join('/')\n\n      let obj = { level: item.path.split('/').length - 1, path: item.path, name: name }\n      if (parent.length > 0) {\n        obj.parent = parent\n      }\n      if (arr.indexOf(JSON.stringify(obj)) === -1) {\n        arr.push(JSON.stringify(obj))\n      }\n\n      let split2 = item.path.split('/')\n      split2.pop()\n      do {\n        let name = split2.pop()\n        let parent = split2.join('/')\n        let path = name\n        if (parent.length > 0) {\n          path = `${parent}/${name}`\n        }\n        let obj = { level: split2.length, path: path, name: name }\n        if (parent.length > 0) {\n          obj.parent = parent\n        }\n        if (arr.indexOf(JSON.stringify(obj)) === -1 && name) {\n          arr.push(JSON.stringify(obj))\n        }\n      } while (split2.length > 0)\n    })\n    arr = arr.map(a => {\n      return JSON.parse(a)\n    })\n    this.setState({ nodes: arr, isLoading: false, level: 0 })\n    return Promise.resolve()\n  }\n\n\n  onImageChange(selected) {\n    if (selected.length > 0) {\n      this.setState({ restoreAssetsDisabled: false, selectedAssets: selected })\n    } else {\n      this.setState({ restoreAssetsDisabled: true, selectedAssets: selected })\n    }\n    return true\n  }\n\n  onSelectAll(a) {\n    let ids = []\n    if (this.state.selectedAssets.length === a.length) {\n      this.setState({ selectedAssets: [], restoreAssetsDisabled: true, })\n    } else {\n      a.forEach(element => {\n        ids.push(element.props.id)\n      })\n      this.setState({ selectedAssets: ids, restoreAssetsDisabled: false, })\n    }\n  }\n\n  confirmFolderRestore() {\n    let path = this.state.selectedFolder\n\n    let filtered = this.state.usersDeletes.hits.filter(del => {\n      if (this.state.includeSubFolders) {\n        return del.path.startsWith(path)\n      } else {\n        return del.path === path\n      }\n    })\n\n    this.setState({\n      showConfirm: true,\n      modalAccentFunc: this.onRestoreFolder.bind(this, path),\n      folderFileCount: filtered.length,\n      modalAssetsOrFolder: 'folder'\n    })\n  }\n\n  onRestoreFolder(path) {\n    this.setState({ showConfirm: false, showProgress: true })\n    let includeSubFolders = this.state.includeSubFolders\n\n    let filtered = this.state.usersDeletes.hits.filter(del => {\n      if (includeSubFolders === true) {\n        if (del.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '').startsWith(path)) {\n          return del\n        }\n      } else {\n        if (del.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '') === path) {\n          return del\n        }\n      }\n    })\n\n    this.processResponse(filtered.chunk(5))\n      .then(() => {\n        let filtered = this.state.usersDeletes.hits.filter(del => {\n          if (includeSubFolders === true) {\n            if (!del.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '').startsWith(path)) {\n              return del\n            }\n          } else {\n            if (del.path.replace(`${window.elvisContext.plugin.configProperties.trash_folder.value}/`, '') !== path) {\n              return del\n            }\n          }\n        })\n\n        // console.log(\"...........................\")\n        // console.log(this.state.usersDeletes, filtered)\n        // console.log(\"...........................\")\n\n\n        this.setState({ usersDeletes: this.state.usersDeletes }, () => {\n          this.createTreeNodes(filtered)\n            .then(() => {\n              this.setState({ showProgress: false, selectedAssets: [] })\n            })\n        })\n      })\n\n  }\n\n  confirmAssetRestore(selected) {\n    this.setState({\n      showConfirm: true,\n      modalAccentFunc: this.onRestoreAssets.bind(this, selected),\n      folderFileCount: selected.length,\n      modalAssetsOrFolder: 'assets'\n    })\n  }\n\n  onRestoreAssets(selected) {\n    this.setState({ showConfirm: false, showProgress: true })\n\n    // console.log({ selected, hits: this.state.usersDeletes.hits, all: this.state.totalAssets })\n\n    let filtered = this.state.totalAssets.filter(item => {\n      if (selected.indexOf(item.id) > -1) {\n        return item\n      }\n    })\n\n    this.processResponse(filtered.chunk(5))\n      .then(() => {\n        let filtered = this.state.usersDeletes.hits.filter(del => {\n          if (selected.indexOf(del.id) === -1) {\n            return del\n          }\n        })\n        //   console.log({ user: this.state.user })\n        let params = {\n          q: `ancestorPaths:\"${window.elvisContext.plugin.configProperties.trash_folder.value}\" ${this.deletedByField}:\"${this.state.user.username}\"`,\n          sort: `${this.deletedOnField}`,\n          num: 5\n        }\n\n\n        // this.getUserDeletes(params)\n        //   .then(res => {\n        //     this.getDeletes(this.state.user.username, true)\n        //     this.setState({ showProgress: false, selectedAssets: [] })\n        //   })\n        //   .catch(err => {\n        //     console.log({ err })\n        //   })\n\n\n        this.state.usersDeletes.hits = filtered\n        this.setState({ usersDeletes: this.state.usersDeletes }, () => {\n          this.createTreeNodes(filtered)\n            .then(() => {\n              this.setState({ showProgress: false, selectedAssets: [], currentPage: 0 })\n            })\n        })\n      })\n\n  }\n\n  onSubFolderCheckboxChange(e) {\n    this.setState({ includeSubFolders: !this.state.includeSubFolders, selectedAssets: [] })\n  }\n\n  processResponse(response) {\n    this.setState({ jobProgressMax: response.length, jobProgress: 0 })\n    return new Promise((resolve, reject) => {\n      let queue = response.map(i => this.restoreAsset.bind(this, i))\n      this.runQueue(queue)\n        .then(() => {\n          resolve()\n        })\n        .catch(error => {\n          reject(error)\n        })\n    })\n  }\n\n  buildQueue(items, func) {\n    return items.map(i => func.bind(this, i))\n  }\n\n  runQueue(queue) {\n    return new Promise((resolve, reject) => {\n      if (queue.length > 0) {\n        queue\n          .shift()\n          .call()\n          .then(temp => {\n            this.runQueue(queue)\n              .then(() => {\n                resolve()\n              })\n              .catch(error => {\n                reject(error)\n              })\n          })\n          .catch(error => {\n            reject(error)\n          })\n      } else {\n        resolve()\n      }\n    })\n  }\n\n  restoreAsset(item) {\n    return new Promise((resolve, reject) => {\n      //  console.log({ item })\n      let encrypted = this.encode(JSON.stringify({ assetSelection: item, user: this.userProfile.username }), window.elvisContext.plugin.configProperties.key.value)\n      let payload = {\n        index: encrypted.iv,\n        data: encrypted.content\n      }\n\n      let params = { assetSelection: item, user: this.userProfile.username }\n      DeleteApi.restore(payload)\n        .then(res => {\n          if (res.status === 200) {\n            this.setState((prevState, props) => ({\n              jobProgress: prevState.jobProgress + 1\n            }))\n            resolve()\n          } else {\n            reject(res.status)\n          }\n        })\n        .catch(err => {\n          console.log(err)\n        })\n\n    })\n  }\n\n  onDropdownSelect(item, index) {\n    this.setState({ isLoading: true, selectedUserIndex: index })\n\n    let params = {\n      q: `ancestorPaths:\"${window.elvisContext.plugin.configProperties.trash_folder.value}\" ${this.deletedByField}:\"${item.value}\"`,\n      sort: `${this.deletedOnField}`,\n      num: 5\n    }\n\n    this.getUserDeletes(params)\n      .then(res => {\n        if (res.totalHits > 0) {\n          let userList = this.state.userList\n          let selectedUser = userList[index].value\n          // console.log({selectedUser})\n          userList[index].deletedOn = res.hits.map(o => { return { value: o.metadata[this.deletedOnField].value, assetPath: o.metadata.assetPath } })\n          this.setState({ userList, selectedUser }, () => {\n            //  console.log({stateUser: this.state.selectedUser})\n            this.getDeletes(item.value, true)\n          })\n        } else {\n          this.setState({ isLoading: false })\n        }\n\n      })\n      .catch(err => {\n        console.log({ err })\n      })\n  }\n\n  getUserDeletes(params) {\n    //console.log({params})\n    return ElvisDriver.getUserDeletes(params)\n  }\n\n\n  getAllUsersInfo(list, data) {\n    return new Promise((resolve, reject) => {\n\n      if (list.length === 0) {\n        resolve(data)\n      } else {\n        let params = {\n          q: `ancestorPaths:\"${window.elvisContext.plugin.configProperties.trash_folder.value}\" ${this.deletedByField}:\"${list[0].value}\"`,\n          sort: `${this.deletedOnField}`,\n          num: 5\n        }\n        this.getUserDeletes(params)\n          .then(res => {\n            if (res.totalHits > 0) {\n              let obj = {\n                user: list[0].value,\n                total: list[0].hitCount,\n                deletedon1: '',\n                deletedon2: '',\n                deletedon3: '',\n                deletedon4: '',\n                deletedon5: '',\n                assetpath1: '',\n                assetpath2: '',\n                assetpath3: '',\n                assetpath4: '',\n                assetpath5: '',\n              }\n              res.hits.forEach((a, i) => {\n                obj[`deletedon${i + 1}`] = moment(a.metadata[this.deletedOnField].value).format()\n                obj[`assetpath${i + 1}`] = a.metadata.assetPath\n              })\n              data.push(obj)\n              list.shift()\n              this.getAllUsersInfo(list, data)\n                .then(() => {\n                  resolve(data)\n                })\n            } else {\n              resolve([])\n            }\n          })\n      }\n    })\n  }\n\n  downloadCSV(event) {\n    this.csv = []\n    return new Promise((resolve, reject) => {\n      let newlist = JSON.parse(JSON.stringify(this.state.userList))\n      this.getAllUsersInfo(newlist, [])\n        .then((data) => {\n          this.csv = data\n          this.setState({ csv: data, showDownloadCSV: true }, () => {\n            resolve()\n          })\n        })\n    })\n\n  }\n\n  render() {\n    const { level, restoreAssetsDisabled, showDownloadCSV, selectedUserIndex, userList, dropdownList, dropdownValue, isAdmin, jobProgressMax, jobProgress, showProgress, includeSubFolders, modalAssetsOrFolder, modalAccentFunc, folderFileCount, showConfirm, nodes, expanded, checked, selectedFolder, imageCollection, usersDeletes, selectedAssets, isLoading } = this.state\n\n    const CustomToggle = React.forwardRef(({ children, onClick }, ref) => (\n      <button\n        class=\"basic-btn-label\"\n        ref={ref}\n        onClick={(e) => {\n          e.preventDefault();\n          onClick(e);\n        }}>\n        <div style={{ display: 'flex' }}>\n          <div>{children}</div>\n          <div style={{ paddingLeft: '10px' }} >&#x25bc; </div>\n        </div>\n      </button >\n    ))\n\n    const CustomMenu = React.forwardRef(\n      ({ children, style, className, 'aria-labelledby': labeledBy }, ref) => {\n        return (\n          <div\n            class=\"dropdown-menu\"\n            ref={ref}\n            style={style}\n            className={className}\n            aria-labelledby={labeledBy}\n          >\n\n            <input\n              autoFocus\n              placeholder=\"Search...\"\n              class=\"trashcan-search mx-3 my-2 w-auto form-control\"\n              value={dropdownValue}\n              onChange={(e) => {\n                this.setState({ dropdownValue: e.target.value })\n              }}\n            />\n\n            <ul className=\"list-unstyled\">\n              {React.Children.toArray(children).filter(\n                (child) =>\n                  !dropdownValue || child.props.children.toLowerCase().startsWith(dropdownValue),\n              )}\n            </ul>\n          </div>\n        );\n      },\n    )\n\n    let nothingFoundMessage = this.text['app.nothingFound']\n    return (\n      <div className=\"app\">\n        {isAdmin ?\n          <div class=\"trashcan-admin-bar\">\n            <div class=\"trashcan-admin-bar-message\">{this.text['app.superuser']}</div>\n            <div style={{ height: '100%', borderRight: '1px solid #e2e2e2', margin: '0 0px 0 14px' }}></div>\n            <div className=\"user-selection\" >\n              <div class=\"basic-btn-title\">{this.text['app.selectedUser']}</div>\n              <div class=\"dropdown\" >\n                <Dropdown drop={'right'} >\n                  <Dropdown.Toggle as={CustomToggle} variant=\"primary\" size=\"sm\" id=\"dropdown-basic\" >\n                    <div style={{ fontWeight: 'bold' }}>{selectedUserIndex > -1 ? userList[selectedUserIndex].value : this.text['app.selectUser']}</div>\n                  </Dropdown.Toggle>\n                  <Dropdown.Menu as={CustomMenu}>\n                    {dropdownList}\n                  </Dropdown.Menu>\n                </Dropdown>\n              </div>\n              <button type=\"button\" class=\"basic-btn outline\" onClick={this.downloadCSV.bind(this)} style={{ height: '24px', marginLeft: '20px' }}>{this.text['app.downloadCsv']}</button>\n\n            </div>\n          </div>\n          : null}\n        <div class=\"trashcan-top-bar\">\n          {selectedUserIndex > -1 && userList[selectedUserIndex].deletedOn ?\n            <>\n              <div class=\"trashcan-top-bar-message\">\n                <Form>\n                  <Form.Check\n                    key={'custom-checkbox'}\n                    checked={includeSubFolders}\n                    custom\n                    onChange={this.onSubFolderCheckboxChange.bind(this)}\n                    type='checkbox'\n                    id={`sub-folder-checkbox`}\n                    label={this.text['app.subfolders']}\n                  />\n                </Form>\n              </div>\n              <div className={'btn-toolbar right'} >\n                <button className=\"basic-btn\" disabled={selectedFolder === ''} onClick={this.confirmFolderRestore.bind(this)} style={{ marginRight: '20px' }}>{this.text['app.restoreFolder']}</button>\n                <button className=\"basic-btn\" disabled={restoreAssetsDisabled} onClick={this.confirmAssetRestore.bind(this, selectedAssets)} >{this.text['app.restoreAssets']}</button>\n              </div>\n            </>\n            : null}\n        </div>\n\n        <ReflexContainer orientation=\"horizontal\">\n          <ReflexElement minSize={200} flex={1} style={{ backgroundColor: '#F2F3F5' }} >\n            {nodes.length > 0 ?\n              // <></>\n              <Panels\n                level={level}\n                data={nodes}\n                onClick={(path) => {\n                  // if folder change, remove any selected assets no longer vaild\n                  //   console.log({ usersDeletes })\n                  let selAssets = usersDeletes.hits.filter((asset, i) => {\n                    if (includeSubFolders) {\n                      return asset.path.startsWith(path) && selectedAssets.indexOf(asset.id) > -1 ? true : false\n                    } else {\n                      return asset.path === path && selectedAssets.indexOf(asset.id) > -1 ? true : false\n                    }\n                  })\n\n                  if (path != selectedFolder) {\n                    this.setState({ selectedFolder: path, checked: [path], restoreFolderDisabled: false, selectedAssets: selAssets.map(o => o.id), restoreAssetsDisabled: selAssets.map(o => o.id).length === 0 })\n                  }\n                }}\n              />\n              :\n              <div className=\"nothing-found\">{nothingFoundMessage}</div>\n            }\n          </ReflexElement>\n          <ReflexSplitter style={{ height: '4px', cursor: 'ns-resize' }} />\n          <ReflexElement minSize={300} flex={2}>\n            <ReflexContainer >\n              <ReflexElement>\n                <div style={{ height: 'calc(100% - 34px)', overflow: 'auto', backgroundColor: '#F5F6F8' }}>\n                  <Gallery onSubFolderCheckboxChange={this.onSubFolderCheckboxChange.bind(this)} onPageclick={this.getDeletes.bind(this)} includeSubFolders={includeSubFolders} onRestoreFolder={this.confirmFolderRestore.bind(this)} onRestoreAssets={this.confirmAssetRestore.bind(this)} onChange={this.onImageChange.bind(this)} onSelectAll={this.onSelectAll.bind(this)} usersDeletes={usersDeletes} currentPage={this.state.currentPage} selectedUser={this.state.selectedUser} selectedAssets={selectedAssets} path={selectedFolder} />\n                  {imageCollection}\n                  <Loader style={{ backgroundColor: 'gba(0, 0, 0, 0.8);' }} fullPage loading={isLoading} text=\"Working, Please Wait.\" />\n                </div>\n              </ReflexElement>\n            </ReflexContainer>\n          </ReflexElement>\n        </ReflexContainer>\n\n\n        <Modal\n          show={showConfirm}\n          onHide={() => { }}\n          // dialogClassName=\"modal-70w\"\n          size=\"\"\n          aria-labelledby=\"header-title\"\n          backdrop='static'>\n          <Modal.Header>\n            <Modal.Title style={{ fontSize: '1.1em', fontWeight: '800' }}>\n              {this.text['recover.title']}\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            {modalAssetsOrFolder === 'folder' ?\n              <>\n                <div className=\"model-title-text\">Folder</div>\n                <div className={'modal-text'}>\n                  {selectedFolder}\n                </div>\n                <div className=\"model-title-text\">{this.text['recover.contains']}</div>\n              </>\n              : null}\n            <div className={'modal-text'}>\n              {folderFileCount} {this.text['text.files']}\n            </div>\n            <div className=\"model-title-text\">\n              {this.text['text.areSure']}\n            </div>\n          </Modal.Body>\n          <Modal.Footer>\n            <ButtonToolbar >\n              <button className=\"basic-btn\" onClick={modalAccentFunc} size=\"sm\">{this.text['button.recover']}</button>\n              <button className=\"basic-btn\" style={{ marginLeft: '20px' }} onClick={() => { this.setState({ showConfirm: false }) }} size=\"sm\">{this.text['button.cancel']}</button>\n            </ButtonToolbar>\n          </Modal.Footer>\n        </Modal>\n\n        <Modal\n          show={showProgress}\n          style={{ padding: 0 }}\n          onHide={() => { }}\n          backdrop='static'\n          size=\"sm\"\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header>\n            <Modal.Title style={{ fontSize: '1.1em', fontWeight: '800' }}>\n              {this.text['progress.recovering']}\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <p>{this.text['progress.message1']}</p>\n            <div>\n              <ProgressBar style={{ backgroundColor: '#0095e0!important' }} now={jobProgress} max={jobProgressMax} label={`${Math.floor(jobProgress * 100 / jobProgressMax)}%`} />\n            </div>\n          </Modal.Body>\n        </Modal>\n\n        <Modal\n          show={showDownloadCSV}\n          onHide={() => { this.setState({ showDownloadCSV: false }) }}\n          // backdrop='static'\n          size=\"sm\"\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header>\n            <Modal.Title style={{ fontSize: '1.1em', fontWeight: '800' }}>\n              <div>{this.text['csv.title']}</div>\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <p>{this.text['csv.message1']}</p>\n            <div>\n              <CSVLink\n                data={this.state.csv}\n                filename={`delete_list-${moment().format()}.csv`}\n                onClick={() => { this.setState({ showDownloadCSV: false }) }}\n              >\n                {this.text['csv.button']}\n              </CSVLink>\n            </div>\n          </Modal.Body>\n        </Modal>\n      </div >\n    )\n  }\n}\n\nexport default App\n","import React, { useReducer } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ImageThumbnail from '../ImageThumbnail/ImageThumbnail'\r\nimport { Form } from 'react-bootstrap'\r\nimport ReactPaginate from 'react-paginate';\r\nimport DeleteApi from '../../helpers/delete_api'\r\nimport App from '../App/App.js'\r\nimport './Gallery.css'\r\n\r\nclass Gallery extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.deletedByField = window.elvisContext.plugin.configProperties.deleted_by_field.value\r\n    this.deletedOnField = window.elvisContext.plugin.configProperties.deleted_on_field.value\r\n    this.trashPath = window.elvisContext.plugin.configProperties.trash_folder.value\r\n    this.text = window.elvisContext.plugin.messages\r\n    this.isAdmin = window.elvisContext.app.userProfile.isAdmin\r\n    this.userProfile = window.elvisContext.app.userProfile\r\n    this.currentPage = 0\r\n    this.assetsPerPage = 50\r\n    this.selectedUser = \"\"\r\n    this.state = {\r\n      currentPage: 0,\r\n      selectedAssets: [],\r\n      includeSubFolders: false,\r\n      images: [],\r\n      setItemOffset: 0,\r\n      itemOffset: 0,\r\n      selectedUser: \"\"\r\n    }\r\n\r\n  }\r\n\r\n  imageSelect(id) {\r\n    let arr = this.props.selectedAssets\r\n    if (arr.indexOf(id) > -1) {\r\n      arr = arr.filter(i => {\r\n        return i !== id\r\n      })\r\n    } else {\r\n      arr.push(id)\r\n    }\r\n\r\n    this.props.selectedAssets = arr// }, (state) => {\r\n    this.setState({ selectedAssets: arr }, () => {\r\n      this.props.onChange(arr)\r\n    })\r\n  }\r\n\r\n  compareValues(key, order = 'asc') {\r\n    return function (a, b) {\r\n      if (!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) {\r\n        // property doesn't exist on either object\r\n        return 0;\r\n      }\r\n\r\n      const varA = (typeof a[key] === 'string') ?\r\n        a[key].toUpperCase() : a[key];\r\n      const varB = (typeof b[key] === 'string') ?\r\n        b[key].toUpperCase() : b[key];\r\n\r\n      let comparison = 0;\r\n      if (varA > varB) {\r\n        comparison = 1;\r\n      } else if (varA < varB) {\r\n        comparison = -1;\r\n      }\r\n      return (\r\n        (order === 'desc') ? (comparison * -1) : comparison\r\n      );\r\n    };\r\n  }\r\n\r\n  selectAllNone() {\r\n\r\n  }\r\n\r\n\r\n  handlePageClick = (event) => {\r\n\r\n    const newOffset = (event.selected * this.assetsPerPage) % this.props.usersDeletes.totalHits;\r\n    if(this.props.selectedUser){\r\n      this.props.onPageclick(this.props.selectedUser, this.isAdmin, newOffset)\r\n    } else {\r\n      this.props.onPageclick(this.userProfile.username, this.isAdmin, newOffset)\r\n    }\r\n   \r\n    this.state.currentPage = event.selected | 0\r\n    //console.log({currentPage: this.currentPage})\r\n  };\r\n\r\n  createStuff() {\r\n    const { usersDeletes, selectedAssets, path } = this.props\r\n    let hits = []\r\n    if (usersDeletes.hits) {\r\n      hits = usersDeletes.hits\r\n\r\n    }\r\n\r\n    let filtered = hits.filter(del => {\r\n\r\n      if (this.props.includeSubFolders == true) {\r\n        if (del.path.replace(`${this.trashPath}/`, '').startsWith(path)) {\r\n          del.selected = false\r\n          return del\r\n        }\r\n      } else {\r\n        if (del.path.replace(`${this.trashPath}/`, '') === path) {\r\n          del.selected = false\r\n          return del\r\n        }\r\n      }\r\n    })\r\n\r\n    filtered = filtered.sort(this.compareValues('value', 'asc'))\r\n\r\n    let arr = []\r\n    filtered.forEach(item => {\r\n      if (!item.cf_deletedOn) {\r\n        item.cf_deletedOn = ''\r\n      }\r\n      arr.push(<ImageThumbnail selected={selectedAssets.indexOf(item.id) > -1} assetId={item.id} id={item.id} path={item.path.replace(`${this.trashPath}/`, '')} deletedOn={item.cf_deletedOn.value} filename={item.filename} W onSelect={this.imageSelect.bind(this, item.id)}></ImageThumbnail>)\r\n    })\r\n\r\n    var size = 1000;\r\n    arr = arr.slice(0, size).map(i => {\r\n      return i\r\n    })\r\n\r\n    // this.props.selectedAssets = arr\r\n    return arr\r\n  }\r\n\r\n  render() {\r\n    let arr = this.createStuff(false)\r\n    const { selectedAssets, path } = this.props\r\n\r\n    let hitsLength = 0\r\n    let totalLength = 0\r\n    let pageCount = 0\r\n    if (this.props.usersDeletes.hits) {\r\n      hitsLength = this.props.usersDeletes.hits.length\r\n      totalLength = this.props.usersDeletes.totalHits\r\n      pageCount = (totalLength / this.assetsPerPage) | 0\r\n    }\r\n    //console.log({pageCount})\r\n\r\n    return (\r\n      <div className={'gallery-box'}>\r\n        <div className={'status-bar '}>\r\n          <div className={'btn-toolbar'}>\r\n            <div style={{ width: '200px' }}>\r\n              {arr.length} {this.text['text.files']} / {selectedAssets.length} {this.text['text.selected']}\r\n            </div>\r\n            <button className=\"basic-btn outline\" onClick={this.props.onSelectAll.bind(this, arr)} size=\"sm\" >{this.text['gallery.selectall']}</button>\r\n          </div>\r\n          {/* <div className={'btn-toolbar right'} >\r\n            <button className=\"basic-btn\" disabled={path === '' || arr.length === 0} onClick={this.props.onRestoreFolder.bind(this, path)} style={{ marginRight: '20px' }}>Restore Folder</button>\r\n            <button className=\"basic-btn\" disabled={selectedAssets.length === 0} onClick={this.props.onRestoreAssets.bind(this, selectedAssets)} style={{ marginRight: '20px' }}>Restore Selection</button>\r\n          </div> */}\r\n        </div>\r\n\r\n        {pageCount > 0 &&\r\n          <ReactPaginate\r\n            breakLabel=\"...\"\r\n            nextLabel=\"next >\"\r\n            onPageChange={this.handlePageClick}\r\n            pageRangeDisplayed={this.assetsPerPage}\r\n            pageCount={totalLength / this.assetsPerPage}\r\n            previousLabel=\"< previous\"\r\n            renderOnZeroPageCount={null}\r\n            className='pagination'\r\n\r\n          />\r\n        }\r\n\r\n\r\n        {hitsLength > 0 &&\r\n          <div class={'paginationText'}>\r\n            {(this.assetsPerPage * this.state.currentPage + 1)}-{(this.assetsPerPage * this.state.currentPage + 1) + hitsLength - 1} ({this.props.usersDeletes.totalHits})\r\n          </div>\r\n        }\r\n\r\n\r\n\r\n\r\n        <div className={'gallery-items'}>\r\n          {arr}\r\n        </div>\r\n      </div >\r\n    )\r\n  }\r\n}\r\n\r\nGallery.propTypes = {\r\n  usersDeletes: PropTypes.array.isRequired,\r\n  selectedAssets: PropTypes.array.isRequired,\r\n  path: PropTypes.string.isRequired,\r\n  onImageSelect: PropTypes.func,\r\n  onChange: PropTypes.func,\r\n  onFinished: PropTypes.func,\r\n  onSelectAll: PropTypes.func,\r\n  onClearAll: PropTypes.func,\r\n  onRestoreFolder: PropTypes.func,\r\n  onRestoreAssets: PropTypes.func,\r\n  onSubFolderCheckboxChange: PropTypes.func,\r\n  includeSubFolders: PropTypes.bool\r\n};\r\n\r\nexport default Gallery;\r\n\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Moment from 'moment'\r\nimport { OverlayTrigger, Popover } from 'react-bootstrap'\r\nimport LazyLoad from 'react-lazy-load';\r\nimport './ImageThumbnail.css'\r\nlet pluginSettings = window.pluginSettings\r\nvar request = require(\"request\");\r\nconst crypto = require('crypto');\r\n\r\n\r\nclass ImageThumbnail extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.apiUrl = window.elvisContext.plugin.configProperties.api.value\r\n    this.text = window.elvisContext.plugin.messages\r\n    this.url = getThumbnail(this.props.assetId, window, this.apiUrl)\r\n  }\r\n\r\n  render() {\r\n    let imageStyle = ''\r\n    if (this.props.selected) {\r\n      imageStyle = 'selected'\r\n    }\r\n\r\n    const popover = (\r\n      <Popover style={{ minWidth: '200px' }}>\r\n        <Popover.Content>\r\n          <div className='image-text-header-tooltip'>{this.text['thumb.filename']}</div>\r\n          <div className='image-text-tooltip'>{this.props.filename}</div>\r\n          <div className='image-text-header-tooltip'>{this.text['thumb.deletedOn']}</div>\r\n          <div className='image-text-tooltip'>{Moment(this.props.deletedOn).format('llll')}</div>\r\n          <div className='image-text-header-tooltip'>{this.text['thumb.path']}</div>\r\n          <div className='image-text-tooltip'>{this.props.path}</div>\r\n        </Popover.Content>\r\n      </Popover>\r\n    );\r\n\r\n    let url = `${window.location.protocol}//${window.location.host}${this.apiUrl}/thumbnail?id=${this.props.assetId}`\r\n\r\n    return (\r\n      <OverlayTrigger\r\n        placement='auto'\r\n        overlay={popover}\r\n        popperConfig={{\r\n          modifiers: {\r\n            applyStyles: true,\r\n            preventOverflow: {\r\n              boundariesElement: 'offsetParent',\r\n              enabled: false\r\n            },\r\n            hide: {\r\n              enabled: false\r\n            }\r\n          }\r\n        }}\r\n        delay={{ show: 1000, hide: 200 }}\r\n      >\r\n        <div id={this.props.assetId} className={`image-container ${imageStyle}`} style={{ cursor: 'pointer' }} onClick={this.props.onSelect.bind(this, this.props.assetId)}>\r\n          <div className={`top-area`}>\r\n            <LazyLoad height={109} offsetTop={100}>\r\n              <div style={{ height: '109px', width: '100%' }}>\r\n                <div class=\"image\" style={{ backgroundImage: `url(\"${this.url}\")` }} />\r\n              </div>\r\n            </LazyLoad>\r\n          </div>\r\n          <div className={`bottom-area`}>\r\n            <p className='image-text-header'>{this.text['thumb.filename']}</p>\r\n            <p className='image-text'>{this.props.filename}</p>\r\n            <p className='image-text-header'>{this.text['thumb.deletedOn']}</p>\r\n            <p className='image-text'>{Moment(this.props.deletedOn).format('llll')}</p>\r\n            <p className='image-text-header'>{this.text['thumb.path']}</p>\r\n            <p className='image-text'>{this.props.path}</p>\r\n          </div>\r\n        </div >\r\n      </OverlayTrigger >\r\n\r\n\r\n    );\r\n  }\r\n}\r\n\r\nImageThumbnail.propTypes = {\r\n  selected: PropTypes.bool,\r\n  assetId: PropTypes.string.isRequired,\r\n  filename: PropTypes.string.isRequired,\r\n  deletedOn: PropTypes.string.isRequired,\r\n  path: PropTypes.string.isRequired,\r\n  onSelect: PropTypes.func,\r\n  ShowBack: PropTypes.bool.isRequired,\r\n  thumbnailUrl: PropTypes.string.isRequired\r\n};\r\n\r\nexport default ImageThumbnail;\r\n\r\n\r\nfunction getThumbnail(id, window, apiUrl) {\r\n  let headerEncrypted = {\r\n    id: id\r\n  }\r\n\r\n  let detailsEncrypted = encode(JSON.stringify(headerEncrypted), window.elvisContext.plugin.configProperties.key.value)\r\n  //let url = `${pluginSettings.server_url}/thumbnail/${id}/*/${id}_thumb.jpg?authcred=${base64data}`\r\n  let url = `${window.location.protocol}//${window.location.host}${apiUrl}/thumbnail?details=${detailsEncrypted.content}&iv=${detailsEncrypted.iv}`\r\n  return url\r\n}\r\n\r\nfunction encode(text, secretKey) {\r\n  const iv = crypto.randomBytes(16)\r\n  const algorithm = 'aes-256-ctr'\r\n  const cipher = crypto.createCipheriv(algorithm, secretKey, iv)\r\n  const encrypted = Buffer.concat([cipher.update(text), cipher.final()])\r\n  return {\r\n    iv: iv.toString('hex'),\r\n    content: encrypted.toString('hex')\r\n  };\r\n}\r\n","import React, { useState, useEffect, useRef } from \"react\"\nimport styled from \"styled-components\"\nimport { ReflexContainer, ReflexSplitter, ReflexElement } from 'react-reflex'\nimport { OverlayTrigger, Tooltip, Popover } from 'react-bootstrap'\nimport folderIcon from '../../images/folder.png'\nimport folderOpenIcon from '../../images/folder-open.png'\n\n\n\nconst StyledPanels = styled.div`\n  line-height: 1.5;\n  margin:0;\n  padding:10px;\n`;\n\nconst StyledText = styled.div` \n  margin-left: 5px;\n  cursor: pointer;  \n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; \n`\nconst StyledIcon = styled.img`\n  cursor: pointer;\n  ${p => {\n    if (p.isSelected && p.isCurrentPath) {\n      return 'filter:brightness(0)invert(1);'\n    }\n  }}\n`\nconst StyledFolder = styled.div`\n  padding: 0 10px;\n  height:25px;\n  line-height: 25px;    \n  font-size: 14px;\n  margin-bottom: 2px;\n  .folder--label {\n    display: flex;\n    align-items: center;\n    span {\n      margin-left: 5px;\n    }\n  }\n  \n  ${p => {\n    if (p.isSelected && p.isCurrentPath) {\n      return 'background-color:#0095E0;color:#ffffff;font-weight:bold; };'\n    } else if (p.isSelected && !p.isCurrentPath) {\n      return 'background-color:#DCDFE6;color:rgb(68,68,68); };'\n    } else {\n      return 'color:rgb(68,68,68)'\n      //return 'font-weight:default; };'\n    }\n  }}\n\n  border-radius: 5px;\n  -webkit-touch-callout: none; /* iOS Safari */\n  -webkit-user-select: none; /* Safari */\n  -khtml-user-select: none; /* Konqueror HTML */\n  -moz-user-select: none; /* Old versions of Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n  user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox *\n`\n\nconst Collapsible = styled.div`\n  height: ${p => (p.isOpen ? \"auto\" : \"0\")};\n  overflow: hidden;\n`\n\nconst FolderItem = ({ name, onSelect, path, level, selectedPath, currentLevel }) => {\n  const [isOpen, setIsOpen] = useState(true)\n  const handleToggle = e => {\n    e.preventDefault()\n    setIsOpen(!isOpen)\n  }\n  let isSelected = selectedPath[level] === path\n  let isCurrentPath = level === currentLevel - 1\n  const popover = (\n    <Popover>\n      <Popover.Content style={{ backgroundColor: 'black', color: 'white' }}>\n        <div style={{ backgroundColor: 'black', color: 'white' }}>{name}</div>\n      </Popover.Content>\n    </Popover>\n  );\n\n  return (\n    <StyledFolder isSelected={isSelected} isCurrentPath={isCurrentPath} onClick={onSelect.bind(this)} >\n      <OverlayTrigger\n        placement='left'\n        overlay={popover}\n        popperConfig={{\n          modifiers: {\n            preventOverflow: {\n              // boundariesElement: 'offsetParent',\n              enabled: false\n            },\n            hide: {\n              enabled: false\n            }\n          }\n        }}\n        delay={{ show: 1000, hide: 200 }}\n      >\n        <div className=\"folder--label\" >\n          {selectedPath[level] === path ? \n          <StyledIcon isSelected={isSelected} isCurrentPath={isCurrentPath} alt=\"expand\" src={folderOpenIcon} width=\"18px\" onClick={handleToggle}></StyledIcon> : <StyledIcon isSelected={isSelected} isCurrentPath={isCurrentPath} alt=\"expand\" src={folderIcon} width=\"18px\" onClick={handleToggle}></StyledIcon>}\n          <StyledText isSelected={isSelected}  >{name}</StyledText>\n        </div>\n      </OverlayTrigger >\n    </StyledFolder >\n  )\n}\n\nconst Panel = ({ data, onSelect, selectedPath, currentLevel }) => {\n  if (!data) {\n    return <></>\n  }\n\n  data = data.sort((a, b) => {\n    let nameA = a.name.toUpperCase()\n    let nameB = b.name.toUpperCase()\n    if (nameA < nameB) {\n      return -1;\n    }\n    if (nameA > nameB) {\n      return 1;\n    }\n  })\n\n\n  return (\n    data.map(item => {\n      return <FolderItem name={item.name} path={item.path} level={item.level} onSelect={onSelect.bind(this, item)} selectedPath={selectedPath} currentLevel={currentLevel} />\n    })\n  )\n}\n\n\nconst Panels = ({ paths, onSelect, selectedPath, currentLevel }) => {\n  let panels = []\n  let newPaths\n  for (let f = 0; f <= currentLevel; f += 1) {\n    if (f === 0) {\n      newPaths = paths.filter(p => p.level === f)\n    } else {\n      newPaths = paths.filter(p => p.level === f && p.parent === selectedPath[f - 1])\n    }\n    if (newPaths.length > 0) {\n      panels.push({ panel: < StyledPanels >< Panel data={newPaths} level={f} onSelect={onSelect.bind(this)} selectedPath={selectedPath} currentLevel={currentLevel} /> </StyledPanels> })\n    }\n  }\n\n  return panels\n}\n\nexport default function FolderPanels({ data, onClick, level }) {\n\n  const [paths, setPaths] = useState(data)\n  const [selectedPaths, setSelectedPaths] = useState({})\n  const [currentLevel, setCurrentLevel] = useState(level)\n\n  if (paths !== data) {\n    setSelectedPaths({})\n    onClick('')\n    setPaths(data)\n  }\n\n  const handleSelection = (item, e) => {\n    e.preventDefault()\n    let newSelected = selectedPaths\n    newSelected[item.level] = item.path\n    setSelectedPaths(newSelected)\n    if (item.level < currentLevel) {\n      for (let g = item.level + 1; g < 100; g += 1) {\n        delete selectedPaths[g]\n      }\n    }\n    setCurrentLevel(item.level + 1)\n    onClick(item.path)\n  };\n\n  const FragWorkAround = ({ orientation, elements }) => {\n    let children = []\n    let sizes = []\n    elements.forEach((q, i) => {\n      if (i === elements.length - 1) {\n        let newSize = elements.length + i\n        if (elements.length < 10) {\n          sizes.push(10 - i)\n        } else {\n\n          sizes.push(1)\n        }\n      } else\n        if (elements.length > 10) {\n          sizes.push(0.5)\n        } else {\n\n          sizes.push(1)\n        }\n    })\n\n    elements.map((el, idx) => {\n      if (idx > 0) {\n        children.push(\n          <ReflexSplitter key={idx + 'S'} propagate={true} />, <ReflexElement minSize={100} key={idx + 'E'} flex={sizes[idx]}>{el.panel}</ReflexElement>\n        )\n      } else {\n        children.push(\n          <ReflexElement key={idx + 'E'} minSize={100} flex={sizes[idx]}> {el.panel}</ReflexElement >\n        )\n      }\n    })\n    return < ReflexContainer orientation={orientation} >\n      {children}\n    </ReflexContainer >\n  }\n\n  return <FragWorkAround orientation=\"vertical\" elements={Panels({ paths: paths, onSelect: handleSelection, selectedPath: selectedPaths, currentLevel: currentLevel })} />\n\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAABACAYAAACX+xC4AAAACXBIWXMAAC4jAAAuIwF4pT92AAAJYWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NjQ4LCAyMDIxLzAxLzEyLTE1OjUyOjI5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjIgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAyLTI4VDE4OjQxOjU2WiIgeG1wOk1vZGlmeURhdGU9IjIwMjEtMDItMjhUMTk6MjU6MDNaIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIxLTAyLTI4VDE5OjI1OjAzWiIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiY2M4NzNmYS1kYjlhLTQ4NDQtODcyZS00OWRiODlhYTE1OTMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1NWY1ZWVmZS0wOGM5LTEyNDItOGQ3My1hNDA5NzBhOGQxZmYiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyOWYxMmEwNC01ZDFlLTQ5ZjItOTU0Yi05Njg3MjBlNDBhOWEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjI5ZjEyYTA0LTVkMWUtNDlmMi05NTRiLTk2ODcyMGU0MGE5YSIgc3RFdnQ6d2hlbj0iMjAyMS0wMi0yOFQxODo0MTo1NloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkMmYzMGMzOS02YWU0LTRmOTctODNjOS02MDg5ZWY5MjJhOWMiIHN0RXZ0OndoZW49IjIwMjEtMDItMjhUMTk6MjBaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMiAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWU0ODQyMzMtMWY3NS00MWYxLWI5ZGEtNDFmZDNmZWRlYTY3IiBzdEV2dDp3aGVuPSIyMDIxLTAyLTI4VDE5OjI1OjAzWiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjIgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmJjYzg3M2ZhLWRiOWEtNDg0NC04NzJlLTQ5ZGI4OWFhMTU5MyIgc3RFdnQ6d2hlbj0iMjAyMS0wMi0yOFQxOToyNTowM1oiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDphZTQ4NDIzMy0xZjc1LTQxZjEtYjlkYS00MWZkM2ZlZGVhNjciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MjlmMTJhMDQtNWQxZS00OWYyLTk1NGItOTY4NzIwZTQwYTlhIiBzdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MjlmMTJhMDQtNWQxZS00OWYyLTk1NGItOTY4NzIwZTQwYTlhIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+JIky8QAAA6FJREFUeNrt3FlIFVEcx/Gb0UbZQgkGFSVBe7aAFIEZREWRYbRgKhRCQtFGUJm0IUQLvURlIAb1UkYLUbQ9GLY99GJGK5VBGthm+2p1+588l/6e7J75jzN17/X38BV1xvvwEWY558wEAvuqA1Q/ai9V51HnqDT92YhHX4ZTb6igD60E8p/gV33CDjUT0I3BvzCcz9RajZQjLIuaQ+2k3hno84D9G/wVg1nj0QcPph4Z6LMB3gBex1AyPPzwQVQ1++wfVCaVGsWNpXp6CZ7t8X+0D1Xl8zniX/eU2hCp4Kqh1IcYQ1cVRSq4ahx1j/pEfYzS3jeBPjlSwVUdqWR93R9tDaMG6nPcXeZVEsngsdJy5nUa4P63inkdA7j/5QMc4AAHOMABDnCAAxwBHOAABzjAo7kVzKv0f4B3oBJbUJuN0UInf5PgBXgbajVVGcWTCm76yry+OfwbNVG/i2rnFjyFuhGD02Z+t9UNeH/qGfBcVSUFV8frK2z/o3raKUOvO0ENqQVRU6k86jXzOi4Fz2P7XsMVi6PzXA0zS5eCl7F9lwHU2gLmVUvFS8BHUt/1fi+pvgC1dobZFksvCzex/Q4D09FSP76oNVUC3p66jYWZotYxL3UJ3UoCnsb2eUJ1BmjY4qgKZlYgvdPczfbZA1BHS/tCXurOdIAEvAf1mO0zAaDWdjCvcungVTbbfv3XeABAw9XFWKKdKwU/ybavB6i1ucxL3WV2l4D3Zst06/UqUqCGr5R5HpSOhy9l284C05p6HOUtM5shBb/Ati0EqLVc5lXT5PkuDPgYfRgJ6n0SAWrtPLPcLp1i29KsubuWV7IxGzRKAq6GFe+z388CqLVC4/LZ0SRylt4wkf3uAW7lrbU1xpoKnIKHHtEuth6LEG+8MbGc5BR8uh4ZrGVPD6cA1FoRMzwlWZeixmwnGceiOICGrasx1pQpfda+hP2cD1BrWczrBdXNKbg6fGykHuqf1VPDQwBq7QgDPyRZ6qYO9pfZteQJYFpLCjR+/ckU6dpC/jz5fICKnkpWQ7KtpeBBNiufAFBrl5hZoZvVs6H2A9PaaOallo+MaA54OkCt8WUjFW7Xh6tu6jWEQP17nYxb+SXNAd8GUGvTjFn5Xm7B6/WxCajhO2CsIHb9Gr2LwLQWTz1vYoTV1Ysi7+gRQ1UOapRa872YusW8KvXxXATu96tQYzn5CuKAvy/7jeUWuTok6W+8fp11LFeuZ8RcnQN+ArEHWHK4MRugAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAABACAYAAACX+xC4AAAACXBIWXMAAC4jAAAuIwF4pT92AAAJYWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NjQ4LCAyMDIxLzAxLzEyLTE1OjUyOjI5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjIgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAyLTI4VDE4OjQxOjU2WiIgeG1wOk1vZGlmeURhdGU9IjIwMjEtMDItMjhUMTk6MjU6NTlaIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIxLTAyLTI4VDE5OjI1OjU5WiIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpjNzdiMTllYi1jYzhlLTQ2MzktODY0MS1jMGM5ZTI3NWFhMDEiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo4NGY5NGQ4Mi04MzNkLWUxNDYtOGY0Zi1jN2FkYjFmNWJkYTIiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyOWYxMmEwNC01ZDFlLTQ5ZjItOTU0Yi05Njg3MjBlNDBhOWEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjI5ZjEyYTA0LTVkMWUtNDlmMi05NTRiLTk2ODcyMGU0MGE5YSIgc3RFdnQ6d2hlbj0iMjAyMS0wMi0yOFQxODo0MTo1NloiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkMmYzMGMzOS02YWU0LTRmOTctODNjOS02MDg5ZWY5MjJhOWMiIHN0RXZ0OndoZW49IjIwMjEtMDItMjhUMTk6MjBaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMiAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OGE2YWQ4YjYtNjU4NC00OTZkLWI0MGQtY2NlOTJiYTQyNDAzIiBzdEV2dDp3aGVuPSIyMDIxLTAyLTI4VDE5OjI1OjU5WiIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjIgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmM3N2IxOWViLWNjOGUtNDYzOS04NjQxLWMwYzllMjc1YWEwMSIgc3RFdnQ6d2hlbj0iMjAyMS0wMi0yOFQxOToyNTo1OVoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4yIChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4YTZhZDhiNi02NTg0LTQ5NmQtYjQwZC1jY2U5MmJhNDI0MDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MjlmMTJhMDQtNWQxZS00OWYyLTk1NGItOTY4NzIwZTQwYTlhIiBzdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MjlmMTJhMDQtNWQxZS00OWYyLTk1NGItOTY4NzIwZTQwYTlhIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+NchfmQAAAb9JREFUeNrt3DtLw2AAheHsTo4ugouoeJlFEAfB2eKFWp0FXbygVBGE/gQXXXQUdBAnwdFFcHBx0kXBTi4VsVZdjCcY8WsrhrZfJAnv8I4J4SGQpNDjOHt5R7WpHVWw1Kka8s+d6FzXrSnvoF71pNwQWga8Gvw8JOzvUoCXg78bOG9q3UeaqbGMmlBb6rkCfQrwH/BHAyZr6UK61F0F+jjgX+AFA2XU4sV0qrxx7g+VVoMxrl+12ASftnwHtKrbkJ8R/92D2owquFe3ekkYutd2VMG9BtSNelWlmFb8BX0kquBeTarPf++PWz2qw3/GXRteu1EGT0oLhtcJ4OG3angdAR5+a4DHGHwM0MCWbILPqmb6s5xN8KLF38STWskmONUW4HEDv1D76pCqOvBtrmyCp3gLCWzRJngG0MCyfPjwpQk44IADDjjggBPggAMOOOCAAw444AQ44IADDjjggAMOOAEOOOCAAw444IADToADDjjggAMOOOCAE+DJAU8DGtiK4XXc6IzeJKCBbTQKbg5FXvp/HfSGHWeoLG8Ec17dG165KE6hJrn2qI39Jrk5p84ZvTDmrJPcmRp26hyK/AStlH7ykYXagQAAAABJRU5ErkJggg==\"","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom'\nimport App from './Components/App/App'\nimport ElvisDriver from './helpers/elvis'\nimport * as serviceWorker from './serviceWorker'\n\n\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport 'react-reflex/styles.css'\nimport './index.css'\n\n\n\n// eslint-disable-next-line no-restricted-globals\nwindow.elvisContext = window.elvisContext || parent.elvisContext || parent.getElvisContext(window) || {}\nconsole.log(`${process.env.REACT_APP_NAME} ${process.env.REACT_APP_VERSION}`)\n\n\n//ReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n\n// ElvisDriver\n//   .init()\n//   .then(ReactDOM.render.bind(this, <App />, document.getElementById('root')), err => alert(err))\n\n\nReactDOM.render(<App />, document.getElementById('root'))","import Elvis from 'elvis-driver/browser';\r\n\r\nexport default {\r\n  serverUrl: '',\r\n\r\n  resolvedLogin: null,\r\n\r\n  _getFolderPath() {\r\n    return (\r\n      window.elvisContext && window.elvisContext.activeTab.folderSelection.length ?\r\n        window.elvisContext.activeTab.folderSelection[0].assetPath :\r\n        '/'\r\n    )\r\n  },\r\n\r\n  _retrieveToken() {\r\n    return (\r\n      fetch('/services/csrf', {\r\n        credentials: 'include'\r\n      }).then(response => (\r\n        response.json()\r\n      ))\r\n    )\r\n  },\r\n\r\n  init() {\r\n    return this\r\n      ._retrieveToken()\r\n      .then(response => {\r\n        const csrfToken = response.csrfToken\r\n        const loginParam = csrfToken ? { csrfToken } : { withCookie: true }\r\n        this.folderPath = this._getFolderPath()\r\n        this.client = Elvis.createClient(this.serverUrl)\r\n        this.resolvedLogin = this.client.login(loginParam)\r\n        return this.resolvedLogin\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  },\r\n\r\n  waitForLogin(func) {\r\n    return new Promise((resolve) => {\r\n      this.resolvedLogin.then(() => {\r\n        resolve(func())\r\n      });\r\n    });\r\n  },\r\n\r\n  browse(options) {\r\n    const params = {\r\n      includeAsset: false,\r\n      ...options\r\n    };\r\n\r\n    return this.waitForLogin(this.client.browse.bind(this.client, params));\r\n  },\r\n\r\n  search(query) {\r\n    return (\r\n      this.client\r\n        .search({ q: query })\r\n    )\r\n  },\r\n\r\n  getUserDeletes(params) {\r\n    return (\r\n      this.client\r\n        .search(params)\r\n    )\r\n  },\r\n\r\n  getUsers(params) {\r\n    return (\r\n      this.client\r\n        .search(params)\r\n    )\r\n  }\r\n}\r\n","//import configs from '../configs/settings.json';\r\nimport elvisDriver from './elvis';\r\nconst crypto = require('crypto');\r\nlet pluginSettings = window.pluginSettings\r\nexport default {\r\n  // url: configs.deleteApiURL,\r\n\r\n  _token: '',\r\n  _apitoken: '',\r\n\r\n  setToken(token) {\r\n    this._token = token;\r\n  },\r\n\r\n  setApiToken(token) {\r\n    this._apitoken = token;\r\n  },\r\n\r\n  getToken() {\r\n    return this._token;\r\n  },\r\n\r\n  getApiToken() {\r\n    return this._apitoken;\r\n  },\r\n\r\n  getHeadersWithDefaults(headers) {\r\n    let headerEncrypted = {\r\n      server_url: pluginSettings.server_url,\r\n      username: pluginSettings.username,\r\n      password: pluginSettings.password,\r\n    }\r\n\r\n    let detailsEncrypted = this.encode(JSON.stringify(headerEncrypted),  window.elvisContext.plugin.configProperties.key.value)\r\n   \r\n    let newHeader = {\r\n      'X-CSRF-TOKEN': this._token,\r\n      'Content-Type': 'application/json',\r\n      'x-api-key': pluginSettings.api_key,\r\n      'trashpath': pluginSettings.trashpath,\r\n      'iv': detailsEncrypted.iv,\r\n      'details': detailsEncrypted.content,\r\n      ...headers\r\n    }\r\n\r\n    if (this._apitoken !== '') {\r\n      newHeader.Authorization = `Bearer ${this.getApiToken()}`\r\n    }\r\n\r\n    return newHeader\r\n  },\r\n\r\n  init(deleteApiURL, trashPath, deletedByField) {\r\n    this.deletedByField = deletedByField\r\n    this.url = deleteApiURL\r\n    this.trashPath = trashPath\r\n\r\n    return new Promise((resolve, reject) => {\r\n      elvisDriver._retrieveToken()\r\n        .then(res => {\r\n          this.setToken(res.csrfToken)\r\n          resolve(res)\r\n        })\r\n        .catch((err) => {\r\n          console.error(err);\r\n        })\r\n    })\r\n  },\r\n\r\n  sendDelete(data) {\r\n    const request = new Request(`${this.url}/api/delete`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n      headers: new Headers(this.getHeadersWithDefaults())\r\n    })\r\n\r\n    return fetch(request);\r\n  },\r\n\r\n  getDeletes(params) {\r\n    const request = new Request(`${this.url}/delete/user_deletes`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n      headers: new Headers(this.getHeadersWithDefaults())\r\n    })\r\n    return fetch(request)\r\n  },\r\n\r\n  getUsers() {\r\n    let params = {\r\n      q: `ancestorPaths:\"${this.trashPath}\"`,\r\n      facets: this.deletedByField\r\n    }\r\n    return elvisDriver.getUsers(params)\r\n    // return fetch(request)\r\n  },\r\n\r\n  encode(text, secretKey) {\r\n    const iv = crypto.randomBytes(16)\r\n    const algorithm = 'aes-256-ctr'\r\n    const cipher = crypto.createCipheriv(algorithm, secretKey, iv)\r\n    const encrypted = Buffer.concat([cipher.update(text), cipher.final()])\r\n    return {\r\n      iv: iv.toString('hex'),\r\n      content: encrypted.toString('hex')\r\n    };\r\n  },\r\n\r\n  restore(params) {\r\n    const request = new Request(`${this.url}/restore`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(params),\r\n      headers: new Headers(this.getHeadersWithDefaults())\r\n    })\r\n\r\n    return fetch(request)\r\n  }\r\n}\r\n"],"sourceRoot":""}